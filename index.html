<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="google-adsense-account" content="ca-pub-9998374393458024">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The News Today</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9998374393458024"
     crossorigin="anonymous"></script>
  <style>
    :root{
      --bg:#f5f7fb; --card:#ffffff; --muted:#636f83; --accent:#0b74de;
      --maxw:1100px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%; margin:0; background:var(--bg); color:#0b1020;}
    body{display:flex; justify-content:center; padding:20px;}
    .wrap{width:100%; max-width:var(--maxw);}
    
    header{display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center; gap:12px; margin-bottom:20px;}
    h1{margin:0; font-size:24px;}
    .meta{color:var(--muted); font-size:14px;}

    .controls{display:flex; flex-wrap:wrap; gap:8px; align-items:center;}
    select, input[type="text"]{padding:8px 10px; border-radius:8px; border:1px solid #e3e8ef; background:#fff; flex:1 1 120px;}
    button{padding:8px 12px; border-radius:8px; border:0; background:var(--accent); color:#fff; cursor:pointer;}

    .loader{margin-bottom:12px; color:var(--muted);}
    .error{color:#a42828; background:#fff0f0; padding:10px; border-radius:8px; margin-bottom:12px;}

    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:16px;}
    .card{background:var(--card); border-radius:12px; overflow:hidden; box-shadow:0 6px 18px rgba(15,30,60,0.06); display:flex; flex-direction:column; min-height:250px; transition: transform 0.2s;}
    .card:hover{transform:translateY(-5px);}
    .thumb{width:100%; height:160px; object-fit:cover; background:#ddd;}
    .content{padding:12px 14px; display:flex; flex-direction:column; gap:8px; flex:1;}
    .title{font-weight:600; font-size:16px; margin:0;}
    .desc{color:var(--muted); font-size:14px; margin:0; flex:1;}
    .card-footer{display:flex; justify-content:space-between; align-items:center; gap:8px; margin-top:6px;}
    .source{font-size:12px; color:var(--muted);}
    .small-btn{padding:6px 10px; border-radius:8px; border:0; background:#eef6ff; color:var(--accent); font-weight:600; cursor:pointer; text-decoration:none; text-align:center;}
    
    footer{margin-top:20px; color:var(--muted); font-size:13px; text-align:center;}

    @media (max-width:600px){
      h1{font-size:20px;}
      .grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr));}
      .thumb{height:140px;}
    }
    @media (max-width:400px){
      header{flex-direction:column; align-items:flex-start;}
      .controls{flex-direction:column; width:100%;}
    }
  </style>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9998374393458024"
     crossorigin="anonymous"></script>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>The News Today</h1>
        <div class="meta">Top headlines (English)</div>
      </div>

      <div class="controls">
        <select id="country">
          <option value="">All Countries</option>
          <option value="us">United States</option>
          <option value="gb">United Kingdom</option>
          <option value="ca">Canada</option>
          <option value="au">Australia</option>
        </select>
        <input id="q" placeholder="Search keyword (optional)" />
        <button id="fetchBtn">Load</button>
      </div>
    </header>

    <div id="status" class="loader" aria-live="polite">Ready</div>
    <div id="error" class="error" style="display:none"></div>
    <main>
      <div id="grid" class="grid"></div>
    </main>

    <footer>
     &copy; copyright by Vanny 2025
    </footer>
  </div>

 <script>
const GNEWS_KEY = '4348ae5aa7a4288e0166ca6706be5171';
const NEWSAPI_KEY = 'dc9995ffa5a14e7193692be515e9a71d';
const MAX_ARTICLES = 20;

const grid = document.getElementById('grid');
const statusEl = document.getElementById('status');
const errorEl = document.getElementById('error');
const fetchBtn = document.getElementById('fetchBtn');
const countryEl = document.getElementById('country');
const qEl = document.getElementById('q');

function formatDate(iso){ try{ return new Date(iso).toLocaleString(); } catch(e){ return iso; } }
function el(tag, cls){ const e=document.createElement(tag); if(cls)e.className=cls; return e; }

// List of NewsAPI fallback URLs
const NEWSAPI_URLS = [
  `https://newsapi.org/v2/everything?domains=wsj.com&apiKey=${NEWSAPI_KEY}`,
  `https://newsapi.org/v2/top-headlines?sources=techcrunch&apiKey=${NEWSAPI_KEY}`,
  `https://newsapi.org/v2/top-headlines?country=us&category=business&apiKey=${NEWSAPI_KEY}`,
  `https://newsapi.org/v2/everything?q=tesla&from=2025-09-23&sortBy=publishedAt&apiKey=${NEWSAPI_KEY}`,
  `https://newsapi.org/v2/everything?q=apple&from=2025-10-22&to=2025-10-22&sortBy=popularity&apiKey=${NEWSAPI_KEY}`
];

async function fetchJSON(url){
  const proxyUrl = 'https://corsproxy.io/?' + encodeURIComponent(url);
  const res = await fetch(proxyUrl);
  if(!res.ok) throw new Error(`HTTP ${res.status}`);
  return res.json();
}

async function loadNews(){
  grid.innerHTML = '';
  errorEl.style.display='none';
  statusEl.textContent='Loading news...';

  const country = countryEl.value;
  const q = qEl.value.trim();

  // GNews URL
  let gnewsUrl = `https://gnews.io/api/v4/top-headlines?token=${GNEWS_KEY}&lang=en&max=${MAX_ARTICLES}`;
  if(country) gnewsUrl += `&country=${country}`;
  if(q) gnewsUrl += `&q=${encodeURIComponent(q)}`;

  // Try GNews first
  try{
    const data = await fetchJSON(gnewsUrl);
    if(data.articles && data.articles.length){
      statusEl.textContent=`${data.articles.length} articles (GNews)`;
      renderArticles(data.articles);
      return;
    } else throw new Error('No articles returned from GNews');
  }catch(err){
    console.warn('GNews failed:', err.message);
    statusEl.textContent='GNews failed, trying NewsAPI...';
  }

  // Try NewsAPI URLs in order
  for(const url of NEWSAPI_URLS){
    try{
      const data = await fetchJSON(url);
      if(data.articles && data.articles.length){
        statusEl.textContent=`${data.articles.length} articles (NewsAPI)`;
        renderArticles(data.articles);
        return;
      }
    }catch(err){
      console.warn('NewsAPI URL failed:', url, err.message);
    }
  }

  // All failed
  statusEl.textContent='Error loading news';
  errorEl.style.display='block';
  errorEl.textContent='All APIs failed or returned no articles.';
}

function renderArticles(articles){
  grid.innerHTML='';
  for(const a of articles){
    const card = el('article','card');
    const img = el('img','thumb'); img.alt=a.title||'news image'; img.src=a.image || a.urlToImage || ''; img.onerror=()=>img.style.display='none';
    card.appendChild(img);

    const content = el('div','content');
    const title = el('h3','title'); title.textContent = a.title || 'No title'; content.appendChild(title);
    const desc = el('p','desc'); desc.textContent = a.description || (a.content ? a.content.slice(0,50)+'...' : ''); content.appendChild(desc);

    const footer = el('div','card-footer');
    const src = el('div','source'); src.innerHTML = `<strong>${a.source?.name||'Source'}</strong> â€¢ ${formatDate(a.publishedAt||a.publishedAt)}`; footer.appendChild(src);

    const readBtn = el('a','small-btn'); readBtn.href = a.url || '#'; readBtn.target='_blank'; readBtn.rel='noopener noreferrer'; readBtn.textContent='Read';
    footer.appendChild(readBtn);

    content.appendChild(footer);
    card.appendChild(content);
    grid.appendChild(card);
  }
}

fetchBtn.addEventListener('click', ()=> loadNews());
(function init(){
  if(!GNEWS_KEY.trim() && !NEWSAPI_KEY.trim()){
    statusEl.textContent='Set your API keys.';
    errorEl.style.display='block';
    errorEl.textContent='Replace YOUR_API_KEYs with your tokens.';
    return;
  }
  loadNews();
})();
</script>

</body>
</html>
